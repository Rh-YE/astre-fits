# Astre FITS - FITS文件查看器VSCode扩展

## 项目简介

astre.fits，（astre源于法语的天体一词），是一个专门用于查看和分析FITS（Flexible Image Transport System）文件的VSCode扩展，当然也支持Cursor和Trae编辑器。它提供了基础的FITS文件解析和可视化功能（包括图像、光谱绘制、表格展示），使天文学家和研究人员能够方便地在VSCode中直接查看和分析FITS文件数据。当前版本可以实现基本的需求，更高性能的需求将在未来版本中提供，欢迎在Github仓库中提交Issue或者贡献您的解决方案。

## 界面功能

当用户打开fits文件，将会自动打开一个窗口展示fits内的数据。用户可以自由切换HDU以展示数据。本扩展支持ImageHDU、BinTableHDU、TableHDU（即ASCII表格），暂时不支持PrimaryHDU中的光谱和表格数据。当fits文件包含扩展HDU时，会自动打开第一个扩展HDU的数据。

当前展示分为三种模式：

### 图像模式
- 鼠标悬停显示当前位置的坐标、WCS坐标（如有）、图片原始的像素值（注：显示时图像已被归一化至0-1范围）
- 支持非线性变换
- 提供完整的Fits头文件信息显示
- 支持切换通道（Axes）顺序以显示DataCube顺序

### 光谱模式
- 光谱图像智能绘制，支持自动/手动模式
- 丰富的交互功能：
  - 支持拖动和缩放
  - 矩形框选择放大区域
  - Ctrl＋滚轮 实现x轴缩放
  - Shift＋滚轮 实现y轴缩放
- 灵活的数据展示：
  - 可选择波长/流量列进行绘制
  - 支持切换显示当前光谱的表格数据
  - 完整的Fits头文件信息显示
- 未来计划支持蒙版和误差的绘制

### 表格模式
- 清晰的表格数据展示
- 支持表格排序功能

## 技术实现

### 核心模块

1. FITSParser
   - 负责底层FITS文件解析
   - 实现了完整的FITS标准规范

2. FITSViewerProvider
   - 提供VSCode自定义编辑器支持
   - 实现FITS文件可视化
   - 处理用户交互和界面更新

3. 数据模型
   - FITSHeader：处理文件头信息
   - FITSHDU：管理头数据单元
   - TableData：处理表格数据
   - ColumnData：管理列数据

## 局限

1. 性能局限
   - 大文件加载可能会较慢，如HST的大视场图片加载较慢且难以拖动，这是受限于Web界面的固有限制
   - 大型FITS文件的加载和解析可能会占用较多内存
   - 复杂表格数据的渲染可能会有性能瓶颈

2. 数据兼容性
   - 部分特殊的FITS扩展格式可能不支持
   - 未测试压缩格式
   - 某些非标准FITS文件可能无法正确解析，已知的有HST cos的光谱可能无法正确展示表格

## 未来改进计划

1. 性能优化
   - 优化大文件的处理机制
   - 改进缓存机制

2. 功能扩展
   - 增加数据分析工具
   - 添加更多数据可视化选项

3. 用户体验
   - 改进错误提示机制
   - 增加更多用户配置选项
   - 优化界面交互设计

## 开发要求

- VSCode 1.97.0 或更高版本
- Node.js
- TypeScript

## 安装使用

1. 在VSCode扩展市场搜索"Astre Fits"
2. 点击安装
3. 安装后可直接打开.fits或.fit文件
4. 扩展会自动激活并显示文件内容

## 参考

1. Definition of the Flexible Image Transport System (FITS) Version 4.0
2. SAOImageDS9: https://ds9.si.edu/doc/ref/how.html

## 贡献指南

欢迎提交问题报告和功能建议到项目的GitHub仓库。如果您想为项目贡献代码，请确保：

1. 遵循项目的代码规范
2. 编写必要的测试用例
3. 提交详细的PR说明

## 致谢

本项目的1.0.0版本完全使用Cursor及其支持的Claude 3.5 Sonet（主要）、Claude 3.7 Sonet、Deepseek R1、O3 mini模型进行从0开发，作者负责监督和测试，并恰当地使用FITS定义来约束代码编写。这种开发方式极大地提高了开发效率，同时保证了代码质量。

## 许可证

本项目遵循MIT许可证。 

