# Astre FITS - FITS文件查看器VSCode扩展

## 项目简介

astre.fits，（astre源于法语的天体一词），是一个专门用于查看和分析FITS（Flexible Image Transport System）文件的VSCode扩展，当然也支持Cursor和Trae编辑器。它提供了基础的FITS文件解析和可视化功能（包括图像、光谱绘制、表格展示），使天文学家和研究人员能够方便地在VSCode中直接查看和分析FITS文件数据。

## 界面功能

当用户单击fits文件，将会自动打开一个窗口展示fits内的数据。用户可以随意切换hdu以展示数据。当前展示分为三种模式：图像模式、光谱模式、表格模式。本扩展支持ImageHDU、BinTableHDU、TableHDU（即ASCII表格），暂时不支持PrimaryHDU中的光谱和表格数据。

当fits文件包含扩展HDU时，会自动打开第一个扩展HDU的数据。

图像HDU集成了以下功能：
- 鼠标悬停显示当前位置的坐标、WCS坐标（如有）、图片原始的Pixel Value（但是显示的图像被归一化到了0-1）
- 非线性变换
- Fits头文件信息显示

光谱HDU集成了以下功能：
- 自动/手动绘制可拖动和缩放的光谱图像
- 矩形框选择放大区域进行局部放大
- 按住Ctrl+滚轮缩放可以实现x轴缩放
- 按住Shift+滚轮缩放可以实现y轴缩放
- 可以在波长流量选框中选择绘制哪一列数据
- 未来将支持蒙版和误差的绘制
- 可以切换显示当前表格数据
- Fits头文件信息显示

表格HDU集成了以下功能：
- 表格数据显示和表格排序

## 技术实现

### 核心模块

1. FITSParser
   - 负责底层FITS文件解析
   - 实现完整的FITS标准规范
   - 支持多种数据格式的解析和转换

2. FITSViewerProvider
   - 提供VSCode自定义编辑器支持
   - 实现FITS文件可视化
   - 处理用户交互和界面更新

3. 数据模型
   - FITSHeader：处理文件头信息
   - FITSHDU：管理头数据单元
   - TableData：处理表格数据
   - ColumnData：管理列数据

### 开发框架
   - 基于VSCode Extension API
   - 使用TypeScript开发

## 局限

1. 性能局限
   - 大文件加载可能会较慢，如HST的大视场图片加载较慢且难以拖动，这受限于web界面
   - 大型FITS文件的加载和解析可能会占用较多内存

2. 数据兼容性
   - 部分特殊的FITS扩展格式可能不支持
   - 未测试压缩格式
   - 开发过程中未测试到的某些非标准FITS文件可能无法正确解析，已知的有HST cos的光谱可能无法正确展示表格。

## 已知问题

1. 性能相关
   - 大型FITS文件的加载和解析可能会占用较多内存
   - 复杂表格数据的渲染可能会有性能瓶颈

2. 兼容性
   - 某些非标准FITS文件可能无法正确解析
   - 特殊的数据格式可能需要额外的解析器支持

## 已确定的未来改进

1. 性能优化
   - 优化大文件的处理机制

2. 功能扩展
   - 支持更多的FITS文件扩展格式
   - 增加数据分析工具

## 参考

1. Definition of the Flexible Image Transport System  (FITS) Version 4.0
2. SAOImageDS9

## 贡献指南

欢迎提交问题报告和功能建议到项目的GitHub仓库。如果您想为项目贡献代码，请确保：

1. 遵循项目的代码规范
2. 编写必要的测试用例
3. 提交详细的PR说明

## 许可证

本项目遵循MIT许可证。 

